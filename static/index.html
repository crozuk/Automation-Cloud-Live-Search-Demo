<!DOCTYPE html>
<html>
<head>
  <title>Live Search Demo</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-reboot@4.4.1/dist/reboot.min.css" rel="stylesheet">
</head>
<body style="padding: 5%">
<h1>Automation Cloud</h1>
<h2>Live Search Test</h2>
<p>Enter search term below -</p>

<form action="javascript:void(0);" onsubmit="getResults()" method="post">
  Input: <input type="text" name="search_term">
  <input type="submit" value="Submit">
</form>
<div id="results">

</div>

<style>
#results {
  padding-top: 20px;
}

#results p {
  margin-bottom: 0;
}
#results a {
  display: block;
  padding-top: 10px;
  padding-bottom: 20px;
  overflow: scroll;
}
#results h3 {
  cursor: pointer;
  text-decoration: underline;
}
</style>

<script>

//Get search results from user input 
function getResults() {
  var form_input = $("input[name='search_term").val();
  response = $.post( "search", { search_term: form_input }, function( data ) {
  console.log(data);
  result_set = data.data;
  //console.log(result_set);
  $('#results').html(function(){
    var html = '';
    $.each(result_set, function(i,item){
          html += '<h3>' + item.title + '</h3>';
          html += '<p>' + item.snippet + '</p>';
          html += '<a target="_blank" href ="' + item.url + '">' + item.url + "</a>";
    });
    return html;
  });
  }, "json");
  console.log(form_input)
  var html = "<p>" + "Loading Search Results..." + "</p>";
  $("#results").html(html)
};

//Process selected item
function selectedItem(selected) {
  var array = [];
  array.push({
    title: selected
  });
  console.log(array);
}

//Bind click event
$("#results").on("click", "h3", function(){
  var selectedResult = $(this).text();
  console.log(selectedResult);
  selectedItem(selectedResult);
});
</script>

</body>
</html>
